# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ CO‚ÇÇ –º–µ—Ç–æ–¥–æ–º Lasslop - 2013 –≥–æ–¥

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö Eddy Covariance –∑–∞ 2013 –≥–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ Lasslop –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ CO‚ÇÇ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

‚úÖ **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤** –º–µ—Ç–æ–¥–æ–º MDS (Marginal Distribution Sampling)
‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤** –º–µ—Ç–æ–¥–æ–º Lasslop: NEE ‚Üí GPP + Reco
‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ u*** (—Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä–µ–Ω–∏—è) —Å —Ç—Ä–µ–º—è —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ (5%, 50%, 95%)
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚úÖ **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ –º–µ—Ç–æ–¥ Lasslop?

**–ú–µ—Ç–æ–¥ Lasslop** (Lasslop et al., 2010) ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ CO‚ÇÇ, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ **–¥–Ω–µ–≤–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –ø–æ —Å–≤–µ—Ç–æ–≤–æ–º—É –æ—Ç–∫–ª–∏–∫—É**.

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- üìä **–ú–æ–¥–µ–ª—å**: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è –≥–∏–ø–µ—Ä–±–æ–ª–∞ —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –¥–ª—è VPD
- üåû **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –û–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è –¥–Ω–µ–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- üî¨ **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `Œ±` ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–π –Ω–∞–∫–ª–æ–Ω —Å–≤–µ—Ç–æ–≤–æ–π –∫—Ä–∏–≤–æ–π
  - `Œ≤` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π GPP –ø—Ä–∏ –Ω–∞—Å—ã—â–µ–Ω–∏–∏ —Å–≤–µ—Ç–æ–º
  - `k` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–ª–∏—è–Ω–∏—è –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –¥–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞ (VPD)
  - `RRef` ‚Äî –±–∞–∑–∞–ª—å–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ 15¬∞C
  - `E0` ‚Äî —ç–Ω–µ—Ä–≥–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –§–æ—Ä–º—É–ª–∞ –º–æ–¥–µ–ª–∏:

```
GPP = (Œ± √ó Œ≤ √ó PPFD) / (Œ± √ó PPFD + Œ≤) √ó f(VPD)
Reco = RRef √ó exp(E0 √ó (1/T_ref - 1/T))
NEE = Reco - GPP
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ –º–µ—Ç–æ–¥–æ–º –†–∞–π—Ö—à—Ç–∞–π–Ω–∞:

‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ VPD –Ω–∞ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑
‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–µ–Ω –¥–ª—è –¥–Ω–µ–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
‚úÖ –õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —É—Å–ª–æ–≤–∏—è—Ö –≤–æ–¥–Ω–æ–≥–æ —Å—Ç—Ä–µ—Å—Å–∞
‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –∑–∞ –Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- R –≤–µ—Ä—Å–∏–∏ ‚â• 4.0.0
- –ú–∏–Ω–∏–º—É–º 4 GB RAM
- 500 MB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ R-–ø–∞–∫–µ—Ç—ã:

```r
install.packages(c(
  "REddyProc",    # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ EC –¥–∞–Ω–Ω—ã—Ö
  "tidyverse",    # –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
  "lubridate",    # –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º
  "stringr"       # –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏
))
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (eddypro_2013.csv):

–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã –∏–∑ EddyPro:

| –°—Ç–æ–ª–±–µ—Ü | –û–ø–∏—Å–∞–Ω–∏–µ | –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è |
|---------|----------|-------------------|
| `date` | –î–∞—Ç–∞ | YYYY-MM-DD |
| `time` | –í—Ä–µ–º—è | HH:MM |
| `co2_flux` | –ü–æ—Ç–æ–∫ CO‚ÇÇ (NEE) | ¬µmol m‚Åª¬≤ s‚Åª¬π |
| `LE` | –õ–∞—Ç–µ–Ω—Ç–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ | W m‚Åª¬≤ |
| `H` | –Ø–≤–Ω—ã–π —Ç–µ–ø–ª–æ–≤–æ–π –ø–æ—Ç–æ–∫ | W m‚Åª¬≤ |
| `Ustar` | –°–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä–µ–Ω–∏—è | m s‚Åª¬π |
| `air_temperature` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ | ¬∞C |
| `VPD` | –î–µ—Ñ–∏—Ü–∏—Ç –¥–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞ | Pa |
| `PPFD_IN` | –§–æ—Ç–æ—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–¥–∏–∞—Ü–∏—è | ¬µmol photons m‚Åª¬≤ s‚Åª¬π |
| `NETRAD` | –ß–∏—Å—Ç–∞—è —Ä–∞–¥–∏–∞—Ü–∏—è | W m‚Åª¬≤ |
| `RH` | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å | % |
| `air_pressure` | –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ | Pa |

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Lasslop_2013_Complete_GapFilled.csv):

| –ì—Ä—É–ø–ø–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------------|----------|
| **–í—Ä–µ–º–µ–Ω–Ω—ã–µ** | DateTime, Year, DoY, season |
| **NEE** | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ + QC —Ñ–ª–∞–≥–∏ |
| **GPP** | –í–∞–ª–æ–≤–∞—è –ø–µ—Ä–≤–∏—á–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è (3 —Å—Ü–µ–Ω–∞—Ä–∏—è u*) |
| **Reco** | –≠–∫–æ—Å–∏—Å—Ç–µ–º–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ (3 —Å—Ü–µ–Ω–∞—Ä–∏—è u*) |
| **–ú–µ—Ç–µ–æ–¥–∞–Ω–Ω—ã–µ** | Tair, VPD, Rg, PPFD, Rn, LE, H (–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ) |
| **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏** | Œ±, Œ≤, k, RRef, E0, GPP2000 |

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:

1. **–ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö** `eddypro_2013.csv` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞

2. **–û—Ç–∫—Ä–æ–π—Ç–µ R/RStudio** –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:
   ```r
   setwd("/home/user/EC_disser")
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç**:
   ```r
   source("Lasslop_2013_GapFilling.R")
   ```

4. **–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è** (–ø—Ä–∏–º–µ—Ä–Ω–æ 5-10 –º–∏–Ω—É—Ç)

### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏:

1. ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ –û—á–∏—Å—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ QC —Ñ–ª–∞–≥–æ–≤
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (30-–º–∏–Ω—É—Ç–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã)
4. ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –º–µ—Ç–µ–æ–¥–∞–Ω–Ω—ã—Ö (Rg, Tair, VPD, LE, H, Rn, PPFD, Tsoil)
5. ‚úÖ –û—Ü–µ–Ω–∫–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π u* (3 —Å—Ü–µ–Ω–∞—Ä–∏—è)
6. ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ NEE —Å —É—á–µ—Ç–æ–º u*
7. ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –º–µ—Ç–æ–¥–æ–º Lasslop
8. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ CSV
9. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ 4 –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤

---

## –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. –î–∞–Ω–Ω—ã–µ: `Lasslop_2013_Complete_GapFilled.csv`

–°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:**

```r
# –ß—Ç–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
data <- read_csv("Lasslop_2013_Complete_GapFilled.csv")

# –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
# NEE_filled    - –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —á–∏—Å—Ç—ã–π –æ–±–º–µ–Ω CO‚ÇÇ
# GPP           - –≤–∞–ª–æ–≤–∞—è –ø–µ—Ä–≤–∏—á–Ω–∞—è –ø—Ä–æ–¥—É–∫—Ü–∏—è
# Reco          - —ç–∫–æ—Å–∏—Å—Ç–µ–º–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ
# NEE_U50       - NEE –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è u* (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
# GPP_U50       - GPP –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è u*
# Reco_U50      - Reco –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è u*
```

### 2. –ì—Ä–∞—Ñ–∏–∫–∏: `Lasslop_Plots_2013/`

#### `01_Flux_TimeSeries.png`
–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã NEE, GPP –∏ Reco —Å —Ç—Ä–µ–Ω–¥–∞–º–∏ (GAM —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)

#### `02_Diurnal_Cycle.png`
–°—Ä–µ–¥–Ω–∏–π —Å—É—Ç–æ—á–Ω—ã–π —Ü–∏–∫–ª –ø–æ—Ç–æ–∫–æ–≤ CO‚ÇÇ (–ø–æ —á–∞—Å–∞–º)

#### `03_Light_Response_Curve.png`
–°–≤–µ—Ç–æ–≤–∞—è –∫—Ä–∏–≤–∞—è: –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å GPP –æ—Ç PPFD (–º–æ–¥–µ–ª—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –≥–∏–ø–µ—Ä–±–æ–ª—ã)

#### `04_Reco_Temperature.png`
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —ç–∫–æ—Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –¥—ã—Ö–∞–Ω–∏—è –æ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞ `Lasslop_2013_GapFilling.R`:

```r
# –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
input_file <- "eddypro_2013.csv"          # –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
output_file <- "My_Results_2013.csv"      # –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª
plots_dir <- "My_Plots"                   # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

# –ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö
start_date <- as.POSIXct("2013-04-01 21:30:00", tz = "UTC")
end_date <- as.POSIXct("2013-09-02 00:00:00", tz = "UTC")

# –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
latitude <- 55.83722
longitude <- 37.56556
timezone <- 3

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã u*
season_starts <- c(60, 152, 244)      # –î–Ω–∏ –≥–æ–¥–∞ –Ω–∞—á–∞–ª–∞ —Å–µ–∑–æ–Ω–æ–≤
ustar_probs <- c(0.05, 0.5, 0.95)     # –ö–≤–∞–Ω—Ç–∏–ª–∏ –¥–ª—è u*
```

---

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
|------------|----------|---------------|
| **NEE** | Net Ecosystem Exchange | < 0: –ø–æ–≥–ª–æ—â–µ–Ω–∏–µ CO‚ÇÇ, > 0: —ç–º–∏—Å—Å–∏—è |
| **GPP** | Gross Primary Production | –í—Å–µ–≥–¥–∞ ‚â• 0 (–ø–æ–≥–ª–æ—â–µ–Ω–∏–µ) |
| **Reco** | Ecosystem Respiration | –í—Å–µ–≥–¥–∞ ‚â• 0 (—ç–º–∏—Å—Å–∏—è) |

### –°–≤—è–∑—å –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏:

```
NEE = Reco - GPP

–ï—Å–ª–∏ GPP > Reco ‚Üí NEE < 0 (–ø–æ–≥–ª–æ—â–µ–Ω–∏–µ, —Å—Ç–æ–∫ CO‚ÇÇ)
–ï—Å–ª–∏ GPP < Reco ‚Üí NEE > 0 (—ç–º–∏—Å—Å–∏—è, –∏—Å—Ç–æ—á–Ω–∏–∫ CO‚ÇÇ)
```

### –°—Ü–µ–Ω–∞—Ä–∏–∏ u*:

| –°—Ü–µ–Ω–∞—Ä–∏–π | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|----------|----------|-------------------|
| **U05** | –ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ (5%) | –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è |
| **U50** | –°—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥ (50%) | **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–æ–≤** |
| **U95** | –í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ (95%) | –°—Ç—Ä–æ–≥–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –¥–ª—è —Ç—É—Ä–±—É–ª–µ–Ω—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π |

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ Lasslop:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø–∏—á–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω | –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç |
|----------|-------------------|----------------|
| **Œ±** | 0.01-0.08 | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–≤–µ—Ç–∞ |
| **Œ≤** | 10-50 | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å |
| **k** | 0-1 | –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –≤–æ–¥–Ω–æ–º—É —Å—Ç—Ä–µ—Å—Å—É |
| **RRef** | 1-10 | –ë–∞–∑–∞–ª—å–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã |
| **E0** | 100-300 | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥—ã—Ö–∞–Ω–∏—è |

---

## –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)

### ‚ùì –ü–æ—á–µ–º—É –º–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö?

–ü—Ä–æ–ø—É—Å–∫–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –∏–∑-–∑–∞:
- –ü–ª–æ—Ö–∏—Ö –º–µ—Ç–µ–æ—É—Å–ª–æ–≤–∏–π (–¥–æ–∂–¥—å, —Ç—É–º–∞–Ω)
- –ù–∏–∑–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö (QC —Ñ–ª–∞–≥–∏)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ u* (–Ω–∏–∑–∫–∞—è —Ç—É—Ä–±—É–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å)
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–∏–±–æ—Ä–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ**: –ú–µ—Ç–æ–¥ MDS –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Ö–æ–∂–∏—Ö –º–µ—Ç–µ–æ—É—Å–ª–æ–≤–∏–π.

### ‚ùì –ö–∞–∫–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π u* –≤—ã–±—Ä–∞—Ç—å?

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **U50** (—Å—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥) –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö —Ç—Ä–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (U05, U50, U95).

### ‚ùì –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤?

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. **–ì—Ä–∞—Ñ–∏–∫ —Å–≤–µ—Ç–æ–≤–æ–π –∫—Ä–∏–≤–æ–π** ‚Äî –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —á–µ—Ç–∫–∞—è –≥–∏–ø–µ—Ä–±–æ–ª–∞
2. **–ì—Ä–∞—Ñ–∏–∫ Reco vs T** ‚Äî –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
3. **–°—É—Ç–æ—á–Ω—ã–π —Ü–∏–∫–ª** ‚Äî GPP –º–∞–∫—Å–∏–º–∞–ª–µ–Ω –¥–Ω–µ–º, Reco –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª–µ–Ω
4. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã FP_qc** ‚Äî –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å ‚â§ 1 (0 = –æ—Ç–ª–∏—á–Ω–æ, 1 = —Ö–æ—Ä–æ—à–æ, 2 = –ø–ª–æ—Ö–æ)

### ‚ùì –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–¥ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ª–µ—Ç?

**–î–∞!** –ò–∑–º–µ–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```r
input_file <- "eddypro_2016.csv"
start_date <- as.POSIXct("2016-04-01 00:00:00", tz = "UTC")
end_date <- as.POSIXct("2016-09-30 23:30:00", tz = "UTC")
```

### ‚ùì –ß–µ–º –º–µ—Ç–æ–¥ Lasslop –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –†–∞–π—Ö—à—Ç–∞–π–Ω–∞?

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Lasslop | –†–∞–π—Ö—à—Ç–∞–π–Ω |
|----------------|---------|-----------|
| **–¢–∏–ø —Ä–µ–≥—Ä–µ—Å—Å–∏–∏** | –î–Ω–µ–≤–Ω–∞—è (—Å–≤–µ—Ç–æ–≤–∞—è) | –ù–æ—á–Ω–∞—è (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è) |
| **–£—á–µ—Ç VPD** | –î–∞ | –ù–µ—Ç |
| **–¢–æ—á–Ω–æ—Å—Ç—å –¥–Ω–µ–º** | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è |
| **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è** | PPFD, VPD, Tair | –¢–æ–ª—å–∫–æ Tair |

---

## –ü—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏–∑–∞ –≤ R

```r
library(tidyverse)
library(lubridate)

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
data <- read_csv("Lasslop_2013_Complete_GapFilled.csv")

# 1. –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥
cumulative <- data %>%
  summarise(
    Total_GPP_mol = sum(GPP_U50 * 30 * 60 / 1e6, na.rm = TRUE),
    Total_Reco_mol = sum(Reco_U50 * 30 * 60 / 1e6, na.rm = TRUE),
    Total_NEE_mol = sum(NEE_U50 * 30 * 60 / 1e6, na.rm = TRUE)
  )

print(cumulative)

# 2. –°—Ä–µ–¥–Ω–∏–µ —Å—É—Ç–æ—á–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –ø–æ –º–µ—Å—è—Ü–∞–º
monthly <- data %>%
  mutate(Month = month(DateTime, label = TRUE)) %>%
  group_by(Month) %>%
  summarise(
    GPP_mean = mean(GPP_U50, na.rm = TRUE),
    Reco_mean = mean(Reco_U50, na.rm = TRUE),
    NEE_mean = mean(NEE_U50, na.rm = TRUE)
  )

print(monthly)

# 3. –ì—Ä–∞—Ñ–∏–∫ –¥–Ω–µ–≤–Ω–æ–≥–æ –∏ –Ω–æ—á–Ω–æ–≥–æ –¥—ã—Ö–∞–Ω–∏—è
data %>%
  mutate(
    Hour = hour(DateTime),
    Period = ifelse(Hour >= 6 & Hour < 20, "–î–µ–Ω—å", "–ù–æ—á—å")
  ) %>%
  ggplot(aes(x = Tair, y = Reco_U50, color = Period)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = "gam") +
  labs(
    title = "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥—ã—Ö–∞–Ω–∏—è –æ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã",
    x = "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)",
    y = "Reco (¬µmol m‚Åª¬≤ s‚Åª¬π)"
  ) +
  theme_minimal()

# 4. –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Å—è—á–Ω—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö
write_csv(monthly, "Monthly_Fluxes_2013.csv")
```

---

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"

```r
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
getwd()

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
setwd("/home/user/EC_disser")

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞
file.exists("eddypro_2013.csv")
```

### –û—à–∏–±–∫–∞: "–ù–µ —É–¥–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç REddyProc"

```r
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ GitHub (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç CRAN)
install.packages("remotes")
remotes::install_github("bgctw/REddyProc")
```

### –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: "–ú–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ö–∞—á–µ—Å—Ç–≤–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã 30% –¥–∞–Ω–Ω—ã—Ö)
2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ eddypro_2013.csv
3. –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–∞–π–ª–µ)

### –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—á–µ–Ω—å –¥–æ–ª–≥–æ (> 20 –º–∏–Ω—É—Ç)

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö (> 1 –≥–æ–¥)
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ RAM (< 4 GB)
- –ú–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π MDS

**–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑–¥–µ–ª–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–∏–æ–¥–æ–≤ (–ø–æ —Å–µ–∑–æ–Ω–∞–º).

---

## –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –Ω–∞—É—á–Ω–æ–π —Ä–∞–±–æ—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—Ü–∏—Ç–∏—Ä—É–π—Ç–µ:

### –ú–µ—Ç–æ–¥ Lasslop:
> Lasslop, G., Reichstein, M., Papale, D., Richardson, A. D., Arneth, A., Barr, A., ... & Wohlfahrt, G. (2010). Separation of net ecosystem exchange into assimilation and respiration using a light response curve approach: critical issues and global evaluation. *Global Change Biology*, 16(1), 187-208.

### –ü–∞–∫–µ—Ç REddyProc:
> Wutzler, T., Lucas-Moffat, A., Migliavacca, M., Knauer, J., Sickel, K., ≈†igut, L., ... & Reichstein, M. (2018). Basic and extensible post-processing of eddy covariance flux data with REddyProc. *Biogeosciences*, 15(16), 5015-5030.

### –ú–µ—Ç–æ–¥ MDS:
> Reichstein, M., Falge, E., Baldocchi, D., Papale, D., Aubinet, M., Berbigier, P., ... & Valentini, R. (2005). On the separation of net ecosystem exchange into assimilation and ecosystem respiration: review and improved algorithm. *Global Change Biology*, 11(9), 1424-1439.

---

## –ê–≤—Ç–æ—Ä—ã –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

**–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞**: Claude Code
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-10-28
**–í–µ—Ä—Å–∏—è**: 1.0

**–°–∞–π—Ç**: –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç
**–õ–æ–∫–∞—Ü–∏—è**: RU-Mos (55.83722¬∞N, 37.56556¬∞E)

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –∫–æ–¥ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –í—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –µ–≥–æ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è REddyProc:
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://www.bgc-jena.mpg.de/bgi/index.php/Services/REddyProcWeb)
- [–í–∏–Ω—å–µ—Ç–∫–∞ –ø–∞–∫–µ—Ç–∞](https://cran.r-project.org/web/packages/REddyProc/vignettes/useCase.html)

### –°—Ç–∞—Ç—å–∏ –ø–æ –º–µ—Ç–æ–¥–∞–º:
- [Lasslop et al., 2010 - –ú–µ—Ç–æ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤](https://doi.org/10.1111/j.1365-2486.2009.01938.x)
- [Reichstein et al., 2005 - –ú–µ—Ç–æ–¥ MDS](https://doi.org/10.1111/j.1365-2486.2005.001002.x)
- [Papale et al., 2006 - QC —Ñ–ª–∞–≥–∏](https://doi.org/10.5194/bg-3-571-2006)

### Eddy Covariance:
- [FLUXNET](https://fluxnet.org/)
- [EddyPro Software](https://www.licor.com/env/products/eddy_covariance/eddypro.html)

---

**–£–¥–∞—á–∏ –≤ –∞–Ω–∞–ª–∏–∑–µ –¥–∞–Ω–Ω—ã—Ö! üå±üìä**
